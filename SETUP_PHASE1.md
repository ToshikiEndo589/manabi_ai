# 第1段階 セットアップガイド

このガイドでは、まなびリズムの第1段階（認証、オンボーディング、ホーム画面）を動作させるための手順を説明します。

## 前提条件

- Node.js 18以上がインストールされていること
- npm または yarn がインストールされていること
- Supabaseアカウントがあること（無料プランで可）

## セットアップ手順

### 1. 依存関係のインストール

```bash
npm install
```

### 2. Supabaseプロジェクトの作成

1. [Supabase](https://supabase.com)にアクセスしてアカウントを作成（またはログイン）
2. 「New Project」をクリックして新しいプロジェクトを作成
3. プロジェクト名、データベースパスワード、リージョンを設定
4. プロジェクトが作成されるまで待つ（数分かかります）

### 3. Supabaseデータベースのセットアップ

1. Supabaseダッシュボードの「SQL Editor」を開く
2. `supabase/setup.sql`の内容をコピーして実行
3. 実行が成功したことを確認（「Success. No rows returned」と表示される）

### 4. 環境変数の設定

1. プロジェクトルートに`.env.local`ファイルを作成
2. Supabaseダッシュボードの「Settings」→「API」から以下を取得：
   - Project URL
   - anon/public key
3. `.env.local`に以下を記述：

```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
```

**注意**: `your_supabase_project_url`と`your_supabase_anon_key`を実際の値に置き換えてください。

### 5. マスコット画像の配置

`public/images/mascot.png`にマスコット画像を配置してください。
画像が存在しない場合、アプリは正常に動作しますが、マスコットが表示されません。

### 6. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてください。

## 動作確認チェックリスト

### 必須確認項目

1. **未ログイン時のリダイレクト**
   - [ ] ブラウザで`http://localhost:3000/app/home`に直接アクセス
   - [ ] `/login`にリダイレクトされることを確認

2. **新規登録とオンボーディング**
   - [ ] `/login`で「新規登録はこちら」をクリック
   - [ ] メールアドレスとパスワード（6文字以上）を入力して新規登録
   - [ ] `/onboarding`にリダイレクトされることを確認
   - [ ] 志望校名と現在偏差値を入力して「設定を完了する」をクリック
   - [ ] `/app/home`にリダイレクトされることを確認

3. **ログイン後の画面**
   - [ ] ホーム画面にマスコット画像が表示されることを確認
   - [ ] 画面下部にボトムナビが表示されることを確認（5つのタブ）

4. **ログアウト**
   - [ ] ボトムナビの「設定」タブをクリック
   - [ ] 「ログアウト」ボタンをクリック
   - [ ] `/login`にリダイレクトされることを確認

5. **再ログイン**
   - [ ] 先ほど登録したメールアドレスとパスワードでログイン
   - [ ] オンボーディングをスキップして直接`/app/home`に遷移することを確認

6. **設定の更新**
   - [ ] ボトムナビの「設定」タブをクリック
   - [ ] 志望校名、現在偏差値、目標偏差値を変更して「設定を更新」をクリック
   - [ ] 更新が成功することを確認

## トラブルシューティング

### 環境変数エラー

**エラー**: `Missing Supabase environment variables`

**解決方法**:
1. `.env.local`ファイルがプロジェクトルートに存在することを確認
2. 環境変数名が正しいか確認（`NEXT_PUBLIC_SUPABASE_URL`と`NEXT_PUBLIC_SUPABASE_ANON_KEY`）
3. 開発サーバーを再起動（`Ctrl+C`で停止してから`npm run dev`で再起動）

### データベースエラー

**エラー**: `relation "profiles" does not exist`

**解決方法**:
1. SupabaseダッシュボードのSQL Editorで`supabase/setup.sql`を実行
2. 実行が成功したことを確認

### 認証エラー

**エラー**: `Invalid login credentials`

**解決方法**:
1. メールアドレスとパスワードが正しいか確認
2. 新規登録の場合は、メールアドレスが既に使用されていないか確認

### マスコット画像が表示されない

**解決方法**:
1. `public/images/mascot.png`に画像ファイルが存在することを確認
2. 画像ファイル名が`mascot.png`であることを確認（大文字小文字も含む）

## 次のステップ

第1段階が正常に動作することを確認したら、第2段階の実装に進みます：

- 学習記録機能（ストップウォッチ、手動入力）
- 学習データ可視化（ヒートマップ、科目別グラフ）
- AI Q&A機能
